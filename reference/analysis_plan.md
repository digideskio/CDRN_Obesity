# Analysis Plan: Mid-south CDRN Obesity Project

The overarching aim of the project is to identify patient variables that are associated with realized patterns of BMI change over time. Our analysis seeks to achieve this aim by decomposing the problem into two distinct sub-objectives. 

1. Identifying classes of BMI trajectories that represent general patterns of BMI change
2. Identify patient attributes that predict the class of BMI trajectory that is observed

The predictors used to model (2) may be derived from two sources, either variables in the electronic health records or potential psychosocial determinants collected from surveys carried out on approximately 11,000 patients from CDRN affiliates.

## Statistical Approach

Classifying BMI time series into relatively homogeneous subsets suggests the use of clustering procedures. However, classical approaches to clustering are based on distance metrics (between points in parameter space), and are not easily generalized to measure the similarity between time series. We will approach the problem with model-based clustering, using finite or infinite mixture models depending on whether the number of groups can be defined *a priori*. 

By clustering, we wish to capture the predictable variation across such time series, implying that each group can be characterized by a distinct data-generating mechanism. A particular observed time series is considered to be a realization of one of these groups, whereby all time series within the same group can be characterized by the same data generating mechanism. The statistical problem is then concerned with how observations are assigned to the suite of groups. Any residual variation is then assumed to be due to unmeasured factors that may influence how realizations may quantitatively differ from other observations within that class of mechanism. 

With a mixture model, group assignment is probabilistic, rather than deterministic, where the probabilities of group membership is determined by the relative fit to the data under each potential generative model. We will be using Bayesian methods to build the mixture models, which allows for the use of Markov chain Monte Carlo (MCMC) methods to iteratively and stochastically assign trajectories to clusters, the parameters of which can be fit simultaneously within the same modeling framework. 

We will consider longitudinal measurements of BMI as observations $y_{it}$, indexed by patient $i$ and measurement time $t$. Hence, a particular trajectory can be written as:

$$\mathbf{y}_i = \{y_{i0}, y_{i1}, y_{i2}, \ldots, y_{in_i}\},$$

where subject $i$ is measured $n_i$ times (not necessarily the same number of times as other subjects). A given BMI time series is then posited to have been generated by a process that governs a particular class of trajectories $G_j$, where $j=1,2,\ldots,J$. We observe $\mathbf{y}_i$ conditional on its cluster membership:

$$p(\mathbf{y}_i | G_{j[i]}) = \left\{ \begin{array}{c}
p_{G_1}(\mathbf{y}_i | \theta_1), \text{if } G_{j[i]} = G_1 \\
p_{G_2}(\mathbf{y}_i | \theta_2), \text{if } G_{j[i]} = G_2 \\
\vdots \\
p_{G_J}(\mathbf{y}_i | \theta_J), \text{if } G_{j[i]} = G_J 
\end{array} \right.,$$

where $\theta_j$ is a vector of parameters corresponding to model $G_j$.

To allow for very flexible modeling of the BMI measurement time series, we will use Gaussian processes (GP), a Bayesian non-parametric regression approach. This avoids being contstrained to standard parametric model forms, and obviates the need to perform model selection among candidate forms. Gaussian processes can be made to model complex non-linear time series, by choosing the appropriate covariance function to describe the variation among observations. A GP describes a distribution over functions, which can be neatly adopted to describe observed BMI trajectories as realizations from a typical underlying pattern in BMI change over time.

A Gaussian process is fully specified by two functions, a mean function $m(t)$ and a covariance function $k(t, t^{\prime})$, 

$$f(t) \sim GP(m(t), k(t, t^{\prime}))$$

This essentially represents an infinitely-dimensional multivariate normal distribution. Because of the ease with which Gaussian distributions can be conditioned and marginalized, values of the GP that we have not observed values for (or are not otherwise interested in) can essentially be ignored. This allows us to use Gaussian processes for regression. 

For example, we can think of observed time series as random draw from the underlying process, as in the figure below.

![Three realizations (solid color lines) from a Gaussian process.](http://d.pr/i/szo2/5AFpuv5i+)



## Limitations and Issues